{"is_source_file": true, "format": "TypeScript", "description": "This file defines the NotesService class, which manages CRUD operations for notes in an Angular application. It handles storage via localStorage and is structured to potentially connect to a backend API in the future. It includes methods for creating, reading, updating, deleting, and searching notes, as well as loading initial data and persisting changes.", "external_files": ["../models/note.model", "./env.service"], "external_methods": ["cryptoRandomId", "safeLocalStorageGetItem", "safeLocalStorageSetItem"], "published": ["NotesService"], "classes": [{"name": "NotesService", "description": "Service class managing notes, including CRUD operations, persistence, and initialization."}], "methods": [{"name": "all$", "description": "Observable stream of all notes sorted by updatedAt descending."}, {"name": "getAll", "description": "Returns a snapshot of all notes, sorted by most recent update."}, {"name": "getById", "description": "Retrieve a specific note by its ID."}, {"name": "create", "description": "Create a new note with given partial data."}, {"name": "update", "description": "Update an existing note identified by ID with specified changes."}, {"name": "delete", "description": "Delete a note by its ID."}, {"name": "search", "description": "Search notes matching a query string in title, content, or tags."}, {"name": "loadInitial", "description": "Load initial notes from localStorage or seed with a default note."}, {"name": "persist", "description": "Persist current notes to localStorage."}, {"name": "sorted", "description": "Sort an array of notes by updatedAt in descending order."}, {"name": "function cryptoRandomId(): string { cryptoRandomId", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function safeLocalStorageGetItem(key: string): string | null { safeLocalStorageGetItem", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function safeLocalStorageSetItem(key: string, value: string): void { safeLocalStorageSetItem", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["this.notes$.asObservable()", "this.notes$.getValue()", "this.sorted()", "safeLocalStorageGetItem", "safeLocalStorageSetItem", "cryptoRandomId()"], "search-terms": ["NotesService", "CRUD notes", "localStorage persistence", "Angular service", "Note model", "notes app API structure"], "state": 2, "file_id": 23, "knowledge_revision": 80, "git_revision": "", "revision_history": [{"47": ""}, {"80": ""}], "ctags": [{"_type": "tag", "name": "LS_KEY", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^const LS_KEY = 'notes-app__notes';$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "NotesService", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^export class NotesService {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "cryptoRandomId", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^function cryptoRandomId(): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "example", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^    const example: Note = {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "g", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^    const g: any = (typeof globalThis !== 'undefined') ? (globalThis as any) : {};$/", "language": "TypeScript", "kind": "constant", "scope": "safeLocalStorageGetItem", "scopeKind": "function"}, {"_type": "tag", "name": "g", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^    const g: any = (typeof globalThis !== 'undefined') ? (globalThis as any) : {};$/", "language": "TypeScript", "kind": "constant", "scope": "safeLocalStorageSetItem", "scopeKind": "function"}, {"_type": "tag", "name": "g", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^  const g: any = (typeof globalThis !== 'undefined') ? (globalThis as any) : {};$/", "language": "TypeScript", "kind": "constant", "scope": "cryptoRandomId", "scopeKind": "function"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^    const next = this.notes$.getValue().filter(n => n.id !== id);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^    const next = this.notes$.getValue().map(n => {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "next", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^    const next = this.sorted([note, ...this.notes$.getValue()]);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "normalized", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^        const normalized = parsed.map(p => ({$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "note", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^    const note: Note = {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "notes$", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^  private notes$ = new BehaviorSubject<Note[]>([]);$/", "language": "TypeScript", "kind": "property", "scope": "NotesService", "scopeKind": "class"}, {"_type": "tag", "name": "now", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^    const now = Date.now();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "parsed", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^        const parsed = JSON.parse(raw) as Note[];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "payload", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^      const payload = JSON.stringify(this.notes$.getValue());$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "q", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^    const q = query.trim().toLowerCase();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "raw", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^      const raw = safeLocalStorageGetItem(LS_KEY);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "safeLocalStorageGetItem", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^function safeLocalStorageGetItem(key: string): string | null {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "safeLocalStorageSetItem", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^function safeLocalStorageSetItem(key: string, value: string): void {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "updated", "path": "/home/kavia/workspace/code-generation/browser-notes-manager-46478-46500/notes_app_frontend/src/app/services/notes.service.ts", "pattern": "/^    let updated: Note | undefined;$/", "language": "TypeScript", "kind": "variable"}], "hash": "98ae3b86ed211978e70e7eced080f049", "format-version": 4, "code-base-name": "notes_app_frontend", "filename": "notes_app_frontend/src/app/services/notes.service.ts", "fields": [{"name": "private notes$ = new BehaviorSubject<Note[]>([]);", "scope": "NotesService", "scopeKind": "class", "description": "unavailable"}, {"name": "let updated: Note | undefined;", "scope": "", "scopeKind": "", "description": "unavailable"}]}